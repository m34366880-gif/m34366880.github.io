# ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° NFT Gift Shop

## ĞĞ±Ğ·Ğ¾Ñ€ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

NFT Gift Shop - ÑÑ‚Ğ¾ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ğ°Ñ web-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹ Telegram Bot Ğ´Ğ»Ñ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ¸ Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ¸ NFT Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ¾Ğ².

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         NFT GIFT SHOP                            â”‚
â”‚                      ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ĞšĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹    â”‚         â”‚   Telegram   â”‚         â”‚    ĞĞ´Ğ¼Ğ¸Ğ½     â”‚
â”‚              â”‚         â”‚     Users    â”‚         â”‚   (IP only)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚ HTTP                   â”‚ Telegram API           â”‚ HTTPS
       â”‚                        â”‚                        â”‚
       â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FastAPI Application                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Frontend   â”‚    â”‚  Telegram    â”‚    â”‚    Admin     â”‚      â”‚
â”‚  â”‚   Routes     â”‚    â”‚     Bot      â”‚    â”‚    Panel     â”‚      â”‚
â”‚  â”‚  (Jinja2)    â”‚    â”‚  (aiogram)   â”‚    â”‚  (IP Check)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                   â”‚                   â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                    â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                     â”‚   Business   â”‚                            â”‚
â”‚                     â”‚    Logic     â”‚                            â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                            â”‚                                    â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                     â”‚  SQLAlchemy  â”‚                            â”‚
â”‚                     â”‚     ORM      â”‚                            â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   SQLite     â”‚
                      â”‚   Database   â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### 1. Frontend Layer (Ğ’ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ)

**Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸:**
- FastAPI (ASGI Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€Ğº)
- Jinja2 (ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€)
- HTML5 + CSS3
- Responsive Design

**ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹:**
- `/` - Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ğ¾Ğ¼
- `/gift/{id}` - Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°
- `/api/gifts` - JSON API Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ¾Ğ²

**Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹:**
```
templates/
â”œâ”€â”€ base.html              # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½
â”œâ”€â”€ index.html             # Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°
â”œâ”€â”€ gift_detail.html       # Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°
â””â”€â”€ 404.html, etc.         # Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
```

### 2. Telegram Bot Layer

**Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸:**
- python-telegram-bot 21.9
- Async/await architecture
- InlineKeyboard Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»:**
```python
NFTGiftBot
â”œâ”€â”€ start_command()           # /start - Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ
â”œâ”€â”€ view_gifts_callback()     # ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ğ°
â”œâ”€â”€ show_gift()               # ĞŸĞ¾ĞºĞ°Ğ· ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°
â”œâ”€â”€ buy_gift()                # ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° NFT
â”œâ”€â”€ send_gift_callback()      # ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸
â”œâ”€â”€ process_gift_sending()    # ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°
â””â”€â”€ my_gifts_callback()       # ĞœĞ¾Ğ¸ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ¸
```

**Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ±Ğ¾Ñ‚Ğ°:**
- ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ñƒ
- ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ¸
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ° (Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ)
- ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸

### 3. Admin Panel Layer

**Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸:**
- IP-based Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
- Cookie-based ÑĞµÑÑĞ¸Ğ¸
- CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸

**Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ:**
```python
# Ğ”Ğ²ÑƒÑ…ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
1. check_admin_ip()         # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° IP Ğ°Ğ´Ñ€ĞµÑĞ°
2. verify_admin_session()   # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞµÑÑĞ¸Ğ¸
```

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»:**
- Dashboard Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¾Ğ¹
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ NFT Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°Ğ¼Ğ¸ (CRUD)
- ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡

**ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹:**
```
/admin/login         # Ğ’Ñ…Ğ¾Ğ´
/admin/dashboard     # ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
/admin/gifts         # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ¾Ğ²
/admin/gifts/add     # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ
/admin/gifts/edit    # Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
/admin/gifts/delete  # Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ
/admin/users         # ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸
/admin/purchases     # Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ
```

### 4. Database Layer

**Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ:** SQLite + SQLAlchemy (Async)

**ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:**

```python
NFTGift (nft_gifts)
â”œâ”€â”€ id: Integer (PK)
â”œâ”€â”€ title: String
â”œâ”€â”€ description: Text
â”œâ”€â”€ gif_url: String
â”œâ”€â”€ file_id: String (Telegram)
â”œâ”€â”€ price: Float
â”œâ”€â”€ is_active: Boolean
â”œâ”€â”€ created_at: DateTime
â””â”€â”€ updated_at: DateTime

User (users)
â”œâ”€â”€ id: Integer (PK)
â”œâ”€â”€ telegram_id: Integer (Unique)
â”œâ”€â”€ username: String
â”œâ”€â”€ first_name: String
â”œâ”€â”€ last_name: String
â””â”€â”€ created_at: DateTime

NFTPurchase (nft_purchases)
â”œâ”€â”€ id: Integer (PK)
â”œâ”€â”€ user_id: Integer (FK)
â”œâ”€â”€ nft_gift_id: Integer (FK)
â”œâ”€â”€ recipient_telegram_id: Integer (FK)
â”œâ”€â”€ status: String (pending/completed/sent)
â”œâ”€â”€ transaction_hash: String
â”œâ”€â”€ created_at: DateTime
â””â”€â”€ sent_at: DateTime
```

**Ğ¡Ğ²ÑĞ·Ğ¸:**
```
User 1â”€â”€âˆ NFTPurchase
NFTGift 1â”€â”€âˆ NFTPurchase
User 1â”€â”€âˆ ReceivedGifts (Ñ‡ĞµÑ€ĞµĞ· recipient_telegram_id)
```

## ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### 1. ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° NFT Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°

```
User Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ±Ğ¾Ñ‚Ğ°
    â”‚
    â”œâ”€â”€ /start
    â”‚
    â”œâ”€â”€ "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ¸"
    â”‚
    â”œâ”€â”€ Ğ‘Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ· Ğ‘Ğ”
    â”‚   SELECT * FROM nft_gifts WHERE is_active=True
    â”‚
    â”œâ”€â”€ ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ GIF + Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
    â”‚
    â”œâ”€â”€ User Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ"
    â”‚
    â”œâ”€â”€ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ÑÑ NFTPurchase
    â”‚   INSERT INTO nft_purchases (...)
    â”‚
    â”œâ”€â”€ Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ transaction_hash
    â”‚   SHA256(user_id + gift_id + timestamp)
    â”‚
    â””â”€â”€ ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ¸
```

### 2. ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°

```
User Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ°Ñ€Ğ¾Ğº Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸
    â”‚
    â”œâ”€â”€ "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ´Ğ°Ñ€Ğ¾Ğº"
    â”‚
    â”œâ”€â”€ Ğ‘Ğ¾Ñ‚ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ
    â”‚   "ĞŸĞµÑ€ĞµÑˆĞ»Ğ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ"
    â”‚
    â”œâ”€â”€ User Ğ¿ĞµÑ€ĞµÑÑ‹Ğ»Ğ°ĞµÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
    â”‚
    â”œâ”€â”€ Ğ‘Ğ¾Ñ‚ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ telegram_id Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ
    â”‚
    â”œâ”€â”€ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ NFTPurchase
    â”‚   UPDATE nft_purchases SET
    â”‚   recipient_telegram_id = ?,
    â”‚   status = 'sent',
    â”‚   sent_at = NOW()
    â”‚
    â”œâ”€â”€ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ GIF Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ
    â”‚   bot.send_animation(recipient_id, ...)
    â”‚
    â””â”€â”€ ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸
```

### 3. Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ğ°Ğ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸

```
Admin Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ /admin/login
    â”‚
    â”œâ”€â”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° IP Ğ°Ğ´Ñ€ĞµÑĞ°
    â”‚   if client_ip != ADMIN_IP: FORBIDDEN
    â”‚
    â”œâ”€â”€ Ğ’Ğ²Ğ¾Ğ´ Ğ»Ğ¾Ğ³Ğ¸Ğ½Ğ°/Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ
    â”‚
    â”œâ”€â”€ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞµÑÑĞ¸Ğ¸
    â”‚   session_token = SHA256(username:password)
    â”‚   Set-Cookie: admin_session=token
    â”‚
    â”œâ”€â”€ /admin/dashboard
    â”‚
    â”œâ”€â”€ Ğ›ÑĞ±Ğ¾Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ñ‡ĞµÑ€ĞµĞ·:
    â”‚   1. check_admin_ip()
    â”‚   2. verify_admin_session()
    â”‚
    â””â”€â”€ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ñƒ
```

## Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### 1. ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ

```python
# IP-based ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°
ADMIN_IP = "80.64.26.253"

def check_admin_ip(request):
    client_ip = request.client.host
    return client_ip == ADMIN_IP or client_ip == "127.0.0.1"
```

### 2. Ğ¡ĞµÑÑĞ¸Ğ¸

```python
# Cookie-based ÑĞµÑÑĞ¸Ğ¸
session_token = hashlib.sha256(
    f"{username}:{password}".encode()
).hexdigest()

response.set_cookie(
    key="admin_session",
    value=session_token,
    httponly=True  # Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ XSS
)
```

### 3. SQL Injection Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°

```python
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ORM Ğ²Ğ¼ĞµÑÑ‚Ğ¾ raw SQL
result = await db.execute(
    select(NFTGift).where(NFTGift.id == gift_id)
)
# ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞºÑ€Ğ°Ğ½Ğ¸Ñ€ÑƒÑÑ‚ÑÑ
```

### 4. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```python
# Pydantic Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
class Settings(BaseSettings):
    TELEGRAM_BOT_TOKEN: str
    ADMIN_IP: str
    # ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²
```

## ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ

### Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° (MVP)
- SQLite (Ğ´Ğ¾ 100,000 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
- Async I/O (Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ)
- In-memory ÑĞµÑÑĞ¸Ğ¸

### Ğ”Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ°ĞºÑˆĞµĞ½Ğ° (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸)

```
1. Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:
   SQLite â†’ PostgreSQL / MySQL
   - ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° concurrent writes
   - Ğ›ÑƒÑ‡ÑˆĞ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
   - ĞĞ°Ğ´ĞµĞ¶Ğ½Ğ¾ÑÑ‚ÑŒ

2. Ğ¡ĞµÑÑĞ¸Ğ¸:
   Memory â†’ Redis
   - Persistence
   - Distributed sessions
   - Caching

3. Ğ¤Ğ°Ğ¹Ğ»Ñ‹:
   Local â†’ S3 / CDN
   - ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
   - Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ°
   - Backup

4. ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ:
   Single â†’ Multiple instances
   - Load balancer (nginx)
   - Horizontal scaling
   - High availability
```

## Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ

### Development

```bash
python main.py
# Uvicorn Ñ hot reload
```

### Production

```bash
# Systemd service
uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4

# Nginx reverse proxy
location / {
    proxy_pass http://127.0.0.1:8000;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
}

# SSL/TLS
certbot --nginx -d yourdomain.com
```

## ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```python
# Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ:

1. Logging:
   import logging
   logging.basicConfig(level=logging.INFO)
   
2. Metrics:
   - ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
   - ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº
   - ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ°
   
3. Error tracking:
   - Sentry integration
   - Error notifications
```

## API Documentation

FastAPI Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ (Future)

Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ:

1. **Payment Integration**
   - TON Wallet
   - Crypto payments
   - Real blockchain

2. **Advanced Features**
   - NFT Marketplace
   - Auction system
   - Rarity system
   - Collections

3. **Social Features**
   - Friends system
   - Gift history
   - Achievements
   - Leaderboards

4. **Analytics**
   - User behavior
   - Popular gifts
   - Revenue tracking

## Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

```
Core:
â”œâ”€â”€ fastapi          # Web framework
â”œâ”€â”€ uvicorn          # ASGI server
â”œâ”€â”€ sqlalchemy       # ORM
â””â”€â”€ python-telegram-bot  # Telegram API

Templates & Static:
â”œâ”€â”€ jinja2           # Template engine
â”œâ”€â”€ aiofiles         # Async file operations
â””â”€â”€ python-multipart # Form handling

Config & Utils:
â”œâ”€â”€ pydantic         # Validation
â”œâ”€â”€ python-dotenv    # Environment
â””â”€â”€ aiosqlite        # Async SQLite
```

---

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ° Ğ½Ğ°**: 2024-10-21
**Ğ’ĞµÑ€ÑĞ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°**: 1.0.0
